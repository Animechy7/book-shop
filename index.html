<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Classic Books</title>
  <style>
    :root{
      --bg:#0b1020;
      --panel:#111a33;
      --panel2:#0f1730;
      --text:#e9eefc;
      --muted:#a9b4d6;
      --brand:#7c5cff;
      --brand2:#2de2e6;
      --danger:#ff4d6d;
      --ok:#2bd576;
      --shadow: 0 18px 55px rgba(0,0,0,.45);
      --radius:16px;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 600px at 15% 10%, rgba(124,92,255,.35), transparent 55%),
                  radial-gradient(900px 500px at 90% 20%, rgba(45,226,230,.25), transparent 55%),
                  radial-gradient(900px 600px at 50% 90%, rgba(255,77,109,.18), transparent 55%),
                  var(--bg);
      color:var(--text);
    }

    a{ color:inherit; text-decoration:none; }

    header{
      position:sticky;
      top:0;
      z-index:10;
      backdrop-filter: blur(10px);
      background: rgba(11,16,32,.55);
      border-bottom: 1px solid rgba(255,255,255,.08);
    }

    .wrap{
      max-width:1100px;
      margin:0 auto;
      padding: 18px 16px;
    }

    .topbar{
      display:flex;
      align-items:center;
      gap:14px;
      justify-content:space-between;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      min-width: 200px;
    }

    .logo{
      width:42px; height:42px;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--brand), var(--brand2));
      box-shadow: 0 10px 35px rgba(124,92,255,.35);
      display:grid; place-items:center;
      font-weight:800;
    }

    .brand h1{
      margin:0;
      font-size: 18px;
      letter-spacing:.4px;
      line-height:1.1;
    }
    .brand small{
      color:var(--muted);
      display:block;
      font-size:12px;
      margin-top:2px;
    }

    .searchRow{
      flex:1;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:center;
    }

    .search{
      width: min(520px, 100%);
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      border-radius: 999px;
      padding: 10px 14px;
      color:var(--text);
      outline:none;
    }

    .pill{
      display:flex;
      gap:8px;
      align-items:center;
      padding: 10px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      cursor:pointer;
      user-select:none;
      transition: transform .12s ease, background .12s ease;
      white-space:nowrap;
    }
    .pill:active{ transform: scale(.98); }
    .pill strong{ font-size:13px; }
    .badge{
      min-width: 24px;
      height: 24px;
      padding: 0 8px;
      border-radius: 999px;
      display:grid;
      place-items:center;
      font-size:12px;
      font-weight:700;
      background: linear-gradient(135deg, var(--brand), var(--brand2));
      color:#071024;
    }

    main .wrap{
      padding-top: 22px;
      padding-bottom: 70px;
    }

    .hero{
      display:grid;
      gap:14px;
      margin-bottom: 18px;
    }
    .hero h2{
      margin:0;
      font-size: 28px;
      letter-spacing:.2px;
    }
    .hero p{
      margin:0;
      color:var(--muted);
      max-width: 70ch;
      line-height: 1.55;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 14px;
      align-items:start;
    }

    .catalog{
      grid-column: span 8;
    }

    .sidebar{
      grid-column: span 4;
      position: sticky;
      top: 88px;
    }

    @media (max-width: 980px){
      .catalog{ grid-column: span 12; }
      .sidebar{ grid-column: span 12; position: static; }
      .searchRow{ display:none; }
    }

    .cards{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 14px;
    }

    @media (max-width: 980px){
      .cards{ grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 520px){
      .cards{ grid-template-columns: 1fr; }
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.04));
      border: 1px solid rgba(255,255,255,.10);
      border-radius: var(--radius);
      overflow:hidden;
      box-shadow: var(--shadow);
      transition: transform .15s ease, border-color .15s ease;
    }
    .card:hover{
      transform: translateY(-2px);
      border-color: rgba(124,92,255,.35);
    }

    /* Cover now supports real images */
    .cover{
      height: 190px;
      background-color: rgba(255,255,255,.06);
      background-size: cover;
      background-position: center;
      position:relative;
      display:flex;
      align-items:flex-end;
      padding: 12px;

      /* fallback gradient so you can see broken images instantly */
      background-image:
        radial-gradient(260px 180px at 30% 20%, rgba(124,92,255,.55), transparent 55%),
        radial-gradient(240px 160px at 80% 30%, rgba(45,226,230,.35), transparent 55%),
        rgba(255,255,255,.06);
    }

    .tag{
      font-size:12px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.14);
      color: var(--text);
      backdrop-filter: blur(6px);
    }

    .cardBody{
      padding: 12px;
      display:grid;
      gap: 8px;
    }

    .title{
      font-weight: 800;
      font-size: 14px;
      line-height:1.25;
      margin:0;
    }

    .meta{
      display:flex;
      justify-content:space-between;
      gap:10px;
      color:var(--muted);
      font-size:12px;
    }

    .btnRow{
      display:flex;
      gap:10px;
      margin-top: 6px;
    }

    button{
      border:0;
      cursor:pointer;
      user-select:none;
      font-weight: 800;
      letter-spacing:.2px;
    }

    .btn{
      flex:1;
      padding: 10px 12px;
      border-radius: 12px;
      background: rgba(255,255,255,.06);
      color:var(--text);
      border:1px solid rgba(255,255,255,.10);
      transition: transform .12s ease, background .12s ease;
    }
    .btn:active{ transform: scale(.98); }

    .btnPrimary{
      background: linear-gradient(135deg, var(--brand), var(--brand2));
      color:#071024;
      border: none;
    }

    .panel{
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border: 1px solid rgba(255,255,255,.10);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .panelHeader{
      padding: 14px 14px 10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
    }

    .panelHeader h3{
      margin:0;
      font-size: 15px;
      letter-spacing:.2px;
    }

    .panelHeader p{
      margin: 6px 0 0;
      color: var(--muted);
      font-size: 12px;
      line-height:1.5;
      max-width: 45ch;
    }

    .panelBody{
      padding: 14px;
      display:grid;
      gap: 12px;
    }

    .field{
      display:grid;
      gap: 6px;
    }

    .field label{
      font-size: 12px;
      color: var(--muted);
    }

    .input{
      width:100%;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      color: var(--text);
      outline:none;
    }

    .cartList{
      display:grid;
      gap: 10px;
      margin-top: 2px;
    }

    .cartItem{
      display:flex;
      justify-content:space-between;
      gap:10px;
      padding: 10px 10px;
      border-radius: 14px;
      background: rgba(0,0,0,.20);
      border: 1px solid rgba(255,255,255,.08);
    }

    .cartItem strong{
      font-size: 13px;
      display:block;
      margin-bottom: 2px;
    }

    .cartItem small{
      color: var(--muted);
      font-size: 12px;
    }

    .qty{
      display:flex;
      align-items:center;
      gap:8px;
    }

    .qtyBtn{
      width:32px; height:32px;
      border-radius: 10px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      color: var(--text);
      font-weight: 900;
    }

    .remove{
      background: rgba(255,77,109,.18);
      border: 1px solid rgba(255,77,109,.30);
      color: #ffd6de;
      padding: 8px 10px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 900;
    }

    .summary{
      display:grid;
      gap:8px;
      padding-top: 10px;
      border-top: 1px solid rgba(255,255,255,.08);
    }

    .line{
      display:flex;
      justify-content:space-between;
      color: var(--muted);
      font-size: 12px;
    }

    .actions{
      display:flex;
      gap:10px;
      margin-top: 8px;
    }

    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      background: rgba(0,0,0,.55);
      border: 1px solid rgba(255,255,255,.12);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 999px;
      font-size: 13px;
      backdrop-filter: blur(8px);
      box-shadow: var(--shadow);
      opacity: 0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
    }
    .toast.show{
      opacity: 1;
      transform: translateX(-50%) translateY(-4px);
    }

    .footerNote{
      margin-top: 10px;
      color: var(--muted);
      font-size: 12px;
      line-height: 1.45;
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="topbar">
        <div class="brand">
          <div class="logo">CB</div>
          <div>
            <h1>Classic Books <small>Pick books, build cart, order on WhatsApp</small></h1>
          </div>
        </div>

        <div class="searchRow">
          <input id="search" class="search" type="search" placeholder="Search books, authors, genres" />
        </div>

        <div class="pill" id="cartJump" title="Cart">
          <strong>Cart</strong>
          <span class="badge" id="cartCount">0</span>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="wrap">
      <div class="hero">
        <h2>Shop classic books and place orders fast</h2>
        <p>Tap Add to cart. Your order is prepared as a WhatsApp message. No backend. No payments. If you want real automation, you need a server. This is just a front-end demo.</p>
      </div>

      <div class="grid">
        <section class="catalog">
          <div class="cards" id="bookGrid"></div>
        </section>

        <aside class="sidebar" id="cartPanel">
          <div class="panel">
            <div class="panelHeader">
              <div>
                <h3>Your Order</h3>
                <p>Fill your name, add items, then send to WhatsApp.</p>
              </div>
              <button class="remove" id="clearCartBtn" type="button">Clear</button>
            </div>

            <div class="panelBody">
              <div class="field">
                <label for="name">Your Name</label>
                <input id="name" class="input" type="text" placeholder="Anime Chy" />
              </div>

              <div class="field">
                <label for="note">Extra Note (optional)</label>
                <input id="note" class="input" type="text" placeholder="Hardcover, gift wrap, deliver tomorrow" />
              </div>

              <div class="cartList" id="cartList"></div>

              <div class="summary">
                <div class="line"><span>Items</span><span id="itemsTotal">0</span></div>
                <div class="line"><span>Estimated Total</span><span id="priceTotal">NPR 0</span></div>
              </div>

              <div class="actions">
                <button class="btn" id="copyBtn" type="button">Copy Message</button>
                <button class="btn btnPrimary" id="whatsappBtn" type="button">Send to WhatsApp</button>
              </div>

              <div class="footerNote">
                WhatsApp cannot be sent automatically from a static website. This opens WhatsApp with the message ready.
              </div>
            </div>
          </div>
        </aside>
      </div>
    </div>
  </main>

  <div class="toast" id="toast">Added to cart</div>

  <script>
    const WHATSAPP_NUMBER = "9779814675428";

    // FIXED: single valid books array (no duplicates)
    const books = [
      { id:"b1", title:"The Great Gatsby", author:"F. Scott Fitzgerald", genre:"Classic", price: 450, tag:"Bestseller", cover:"images/7F451.jpg" },
      { id:"b2", title:"1984", author:"George Orwell", genre:"Dystopian", price: 500, tag:"Must Read", cover:"images/2A-Clockwork-Orange-Book-Cover-368x600-1.jpg" },
      { id:"b3", title:"Pride and Prejudice", author:"Jane Austen", genre:"Romance", price: 420, tag:"Classic", cover:"images/1prideandprejudice.jpg" },
      { id:"b4", title:"To Kill a Mockingbird", author:"Harper Lee", genre:"Classic", price: 480, tag:"Top Pick", cover:"images/4american-psycho-670x1024-1.jpg" },
      { id:"b5", title:"Moby-Dick", author:"Herman Melville", genre:"Adventure", price: 550, tag:"Epic", cover:"images/3px-The_Grapes_of_Wrath_1939_1st_ed_cover.jpg" },
      { id:"b6", title:"The Alchemist", author:"Paulo Coelho", genre:"Fiction", price: 520, tag:"Popular", cover:"images/5bravenewworld.jpg" },
      { id:"b7", title:"Crime and Punishment", author:"Fyodor Dostoevsky", genre:"Literary", price: 650, tag:"Deep", cover:"images/8engulfedinflames.jpg" },
      { id:"b8", title:"The Hobbit", author:"J.R.R. Tolkien", genre:"Fantasy", price: 600, tag:"Fan Favorite", cover:"images/6Animorphs.jpg" },
      { id:"b9", title:"Wuthering Heights", author:"Emily Bronte", genre:"Classic", price: 430, tag:"Classic", cover:"images/9faceofangel.jpg" }
    ];

    const state = {
      cart: JSON.parse(localStorage.getItem("cb_cart") || "{}"),
      query: ""
    };

    const elGrid = document.getElementById("bookGrid");
    const elCartList = document.getElementById("cartList");
    const elCartCount = document.getElementById("cartCount");
    const elItemsTotal = document.getElementById("itemsTotal");
    const elPriceTotal = document.getElementById("priceTotal");
    const elToast = document.getElementById("toast");

    function money(n){ return "NPR " + n.toLocaleString("en-US"); }

    function save(){
      localStorage.setItem("cb_cart", JSON.stringify(state.cart));
    }

    function toast(msg){
      elToast.textContent = msg;
      elToast.classList.add("show");
      setTimeout(() => elToast.classList.remove("show"), 900);
    }

    function filteredBooks(){
      const q = state.query.trim().toLowerCase();
      if(!q) return books;
      return books.filter(b =>
        (b.title + " " + b.author + " " + b.genre).toLowerCase().includes(q)
      );
    }

    function renderBooks(){
      const list = filteredBooks();
      elGrid.innerHTML = list.map(b => {
        const inCart = state.cart[b.id]?.qty || 0;

        // If b.cover exists, prepend it as the LAST background layer so it actually shows.
        // If it fails to load, you'll still see the fallback gradient.
        const coverStyle = b.cover
          ? `style="background-image:url('${b.cover}'), radial-gradient(260px 180px at 30% 20%, rgba(124,92,255,.55), transparent 55%), radial-gradient(240px 160px at 80% 30%, rgba(45,226,230,.35), transparent 55%), rgba(255,255,255,.06);"`
          : "";

        return `
          <article class="card">
            <div class="cover" ${coverStyle}>
              <span class="tag">${b.tag}</span>
            </div>
            <div class="cardBody">
              <p class="title">${b.title}</p>
              <div class="meta">
                <span>${b.author}</span>
                <span>${money(b.price)}</span>
              </div>
              <div class="meta">
                <span>${b.genre}</span>
                <span>${inCart > 0 ? ("In cart: " + inCart) : ""}</span>
              </div>
              <div class="btnRow">
                <button class="btn" type="button" data-action="details" data-id="${b.id}">Details</button>
                <button class="btn btnPrimary" type="button" data-action="add" data-id="${b.id}">Add to cart</button>
              </div>
            </div>
          </article>
        `;
      }).join("");
    }

    function cartItems(){
      const items = [];
      for(const id in state.cart){
        const book = books.find(b => b.id === id);
        if(!book) continue;
        items.push({ book, qty: state.cart[id].qty });
      }
      return items;
    }

    function totals(){
      const items = cartItems();
      const count = items.reduce((a,x) => a + x.qty, 0);
      const sum = items.reduce((a,x) => a + x.qty * x.book.price, 0);
      return { count, sum };
    }

    function renderCart(){
      const items = cartItems();
      if(items.length === 0){
        elCartList.innerHTML = `<div class="footerNote">Your cart is empty. Add some books.</div>`;
      } else {
        elCartList.innerHTML = items.map(x => `
          <div class="cartItem">
            <div>
              <strong>${x.book.title}</strong>
              <small>${x.book.author} â€¢ ${money(x.book.price)}</small>
            </div>
            <div class="qty">
              <button class="qtyBtn" type="button" data-action="dec" data-id="${x.book.id}">-</button>
              <strong>${x.qty}</strong>
              <button class="qtyBtn" type="button" data-action="inc" data-id="${x.book.id}">+</button>
              <button class="remove" type="button" data-action="remove" data-id="${x.book.id}">X</button>
            </div>
          </div>
        `).join("");
      }

      const t = totals();
      elCartCount.textContent = String(t.count);
      elItemsTotal.textContent = String(t.count);
      elPriceTotal.textContent = money(t.sum);
      save();
    }

    function addToCart(id){
      state.cart[id] = state.cart[id] || { qty: 0 };
      state.cart[id].qty += 1;
      toast("Added to cart");
      renderBooks();
      renderCart();
    }

    function changeQty(id, delta){
      if(!state.cart[id]) return;
      state.cart[id].qty += delta;
      if(state.cart[id].qty <= 0) delete state.cart[id];
      renderBooks();
      renderCart();
    }

    function removeItem(id){
      delete state.cart[id];
      renderBooks();
      renderCart();
    }

    function clearCart(){
      state.cart = {};
      renderBooks();
      renderCart();
      toast("Cart cleared");
    }

    function buildMessage(){
      const name = document.getElementById("name").value.trim() || "Customer";
      const note = document.getElementById("note").value.trim();

      const items = cartItems();
      if(items.length === 0) return null;

      const lines = [];
      lines.push("New Book Order");
      lines.push("Name: " + name);
      lines.push("");
      lines.push("Items:");
      items.forEach((x, i) => {
        lines.push(`${i+1}. ${x.book.title} (${x.book.author}) x${x.qty} = ${money(x.book.price * x.qty)}`);
      });

      const t = totals();
      lines.push("");
      lines.push("Total Items: " + t.count);
      lines.push("Estimated Total: " + money(t.sum));

      if(note){
        lines.push("");
        lines.push("Note: " + note);
      }

      return lines.join("\n");
    }

    function openWhatsApp(){
      const msg = buildMessage();
      if(!msg){
        toast("Add items first");
        return;
      }
      const url = "https://wa.me/" + WHATSAPP_NUMBER + "?text=" + encodeURIComponent(msg);
      window.location.href = url;
    }

    async function copyMessage(){
      const msg = buildMessage();
      if(!msg){
        toast("Add items first");
        return;
      }
      try{
        await navigator.clipboard.writeText(msg);
        toast("Message copied");
      }catch(e){
        const ta = document.createElement("textarea");
        ta.value = msg;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        ta.remove();
        toast("Message copied");
      }
    }

    elGrid.addEventListener("click", (e) => {
      const btn = e.target.closest("button");
      if(!btn) return;
      const id = btn.dataset.id;
      const action = btn.dataset.action;

      if(action === "add") addToCart(id);
      if(action === "details"){
        const b = books.find(x => x.id === id);
        alert(`${b.title}\nAuthor: ${b.author}\nGenre: ${b.genre}\nPrice: ${money(b.price)}\n\nThis is a demo. Add to cart to order.`);
      }
    });

    elCartList.addEventListener("click", (e) => {
      const btn = e.target.closest("button");
      if(!btn) return;
      const id = btn.dataset.id;
      const action = btn.dataset.action;

      if(action === "inc") changeQty(id, +1);
      if(action === "dec") changeQty(id, -1);
      if(action === "remove") removeItem(id);
    });

    document.getElementById("clearCartBtn").addEventListener("click", clearCart);
    document.getElementById("whatsappBtn").addEventListener("click", openWhatsApp);
    document.getElementById("copyBtn").addEventListener("click", copyMessage);

    document.getElementById("search").addEventListener("input", (e) => {
      state.query = e.target.value;
      renderBooks();
    });

    document.getElementById("cartJump").addEventListener("click", () => {
      document.getElementById("cartPanel").scrollIntoView({ behavior: "smooth", block: "start" });
    });

    renderBooks();
    renderCart();
  </script>
</body>
</html>
